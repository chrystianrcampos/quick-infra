{
    email internal
}

opensearch.localhost {
    encode zstd gzip
    tls internal

    header {
        Strict-Transport-Security "max-age=31536000;"
        X-Content-Type-Options "nosniff"
    }

    reverse_proxy opensearch:9200 {
        header_up X-Real-IP {remote_host}
        
        transport http {
            keepalive 5m
        }
    }

    log {
        output file /var/log/caddy/opensearch-access.json
        format json
    }
}

dashboards.localhost {
    encode zstd gzip
    tls internal

    header {
        Strict-Transport-Security "max-age=31536000;"
        X-XSS-Protection "1; mode=block"
        X-Frame-Options "SAMEORIGIN"
    }

    reverse_proxy dashboards:5601

    log {
        output file /var/log/caddy/dashboards-access.json
        format json
    }
}
